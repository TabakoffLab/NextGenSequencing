sampleList = paste(rep(c("BNLx","SHR"),each=4),c(1:4),sep=".")
sampleList = paste(rep(c("BNLx","SHR"),each=4),c(1:4),sep="")
sampleList
alignStats = c()
for(i in sampleList){
x = read.table(file=paste("/Volumes/LauraS/NextGenSeq/BNLx.SHR.Heart.totalRNA/data/rRNA.summary.",i,".txt",sep=""),sep="\t",header=FALSE)
sample = i
numReads = as.numeric(gsub(":","",gsub("Input","",x[2,1])))
mappedLeft = as.numeric(gsub(":","",gsub("Mapped","",unlist(lapply(strsplit(x[3,1],split="(",fixed=TRUE),function(a) a[1])))))
mappedRight = as.numeric(gsub(":","",gsub("Mapped ","",unlist(lapply(strsplit(x[7,1],split="(",fixed=TRUE),function(a) a[1])))))
multiLeft = as.numeric(gsub("of these: ","",unlist(lapply(strsplit(x[4,1],split="(",fixed=TRUE),function(a) a[1]))))
multiRight = as.numeric(gsub("of these: ","",unlist(lapply(strsplit(x[8,1],split="(",fixed=TRUE),function(a) a[1]))))
lotsLeft = as.numeric(gsub(" have >20)","",unlist(lapply(strsplit(x[4,1],split="(",fixed=TRUE),function(a) a[3]))))
lotsRight = as.numeric(gsub(" have >20)","",unlist(lapply(strsplit(x[8,1],split="(",fixed=TRUE),function(a) a[3]))))
mappedPairs = as.numeric(gsub("Aligned pairs: ","",x[10,1]))
multiPairs = as.numeric(gsub("of these: ","",unlist(lapply(strsplit(x[11,1],split="(",fixed=TRUE),function(a) a[1]))))
discordPairs = as.numeric(gsub("and: ","",unlist(lapply(strsplit(x[12,1],split="(",fixed=TRUE),function(a) a[1]))))
alignStats = rbind(alignStats,data.frame(sample,numReads,mappedLeft,mappedRight,multiLeft,multiRight,lotsLeft,lotsRight,mappedPairs,multiPairs,discordPairs))
}
i
x = read.table(file=paste("/Volumes/LauraS/NextGenSeq/BNLx.SHR.Heart.totalRNA/data/rRNA.summary.",i,".txt",sep=""),sep="\t",header=FALSE)
x
numReads = as.numeric(gsub(":","",gsub("Input","",x[2,1])))
numReads
mappedLeft = as.numeric(gsub(":","",gsub("Mapped","",unlist(lapply(strsplit(x[3,1],split="(",fixed=TRUE),function(a) a[1])))))
x[3,1]
setwd("/Volumes/LauraS/NextGenSeq/BNLx.SHR.Heart.totalRNA/data")
options(stringsAsFactors=FALSE)
sampleList = paste(rep(c("BNLx","SHR"),each=4),c(1:4),sep="")
alignStats = c()
for(i in sampleList){
x = read.table(file=paste("/Volumes/LauraS/NextGenSeq/BNLx.SHR.Heart.totalRNA/data/rRNA.summary.",i,".txt",sep=""),sep="\t",header=FALSE)
sample = i
numReads = as.numeric(gsub(":","",gsub("Input","",x[2,1])))
mappedLeft = as.numeric(gsub(":","",gsub("Mapped","",unlist(lapply(strsplit(x[3,1],split="(",fixed=TRUE),function(a) a[1])))))
mappedRight = as.numeric(gsub(":","",gsub("Mapped ","",unlist(lapply(strsplit(x[7,1],split="(",fixed=TRUE),function(a) a[1])))))
multiLeft = as.numeric(gsub("of these: ","",unlist(lapply(strsplit(x[4,1],split="(",fixed=TRUE),function(a) a[1]))))
multiRight = as.numeric(gsub("of these: ","",unlist(lapply(strsplit(x[8,1],split="(",fixed=TRUE),function(a) a[1]))))
lotsLeft = as.numeric(gsub(" have >20)","",unlist(lapply(strsplit(x[4,1],split="(",fixed=TRUE),function(a) a[3]))))
lotsRight = as.numeric(gsub(" have >20)","",unlist(lapply(strsplit(x[8,1],split="(",fixed=TRUE),function(a) a[3]))))
mappedPairs = as.numeric(gsub("Aligned pairs: ","",x[10,1]))
multiPairs = as.numeric(gsub("of these: ","",unlist(lapply(strsplit(x[11,1],split="(",fixed=TRUE),function(a) a[1]))))
discordPairs = as.numeric(gsub("and: ","",unlist(lapply(strsplit(x[12,1],split="(",fixed=TRUE),function(a) a[1]))))
alignStats = rbind(alignStats,data.frame(sample,numReads,mappedLeft,mappedRight,multiLeft,multiRight,lotsLeft,lotsRight,mappedPairs,multiPairs,discordPairs))
}
warnings()
alignStats
alignStats$pctReadFrag = (alignStats$mappedLeft + alignStats$mappedRight)/(alignStats$numReads*2)
alignStats
alignStats$pctPairedReads = (alignStats$mappedLeft + alignStats$mappedRight - alignStats$mappedPairs)/alignStats$numReads
alignStats
alignStats$numReadFrag = (alignStats$mappedLeft + alignStats$mappedRight)
alignStats$numDeletedPairedReads = (alignStats$mappedLeft + alignStats$mappedRight - alignStats$mappedPairs)
alignStats = alignStats[,c("numReads","numReadFrag","mappedPairs","numDeletedPairedReads")]
alignTable = data.frame(t(alignStats))
colnames(alignTable) = alignTable[1,]
alignTable = alignTable[-1,]
alignTable
alignStats = c()
for(i in sampleList){
x = read.table(file=paste("/Volumes/LauraS/NextGenSeq/BNLx.SHR.Heart.totalRNA/data/rRNA.summary.",i,".txt",sep=""),sep="\t",header=FALSE)
sample = i
numReads = as.numeric(gsub(":","",gsub("Input","",x[2,1])))
mappedLeft = as.numeric(gsub(":","",gsub("Mapped","",unlist(lapply(strsplit(x[3,1],split="(",fixed=TRUE),function(a) a[1])))))
mappedRight = as.numeric(gsub(":","",gsub("Mapped ","",unlist(lapply(strsplit(x[7,1],split="(",fixed=TRUE),function(a) a[1])))))
mappedPairs = as.numeric(gsub("Aligned pairs: ","",x[10,1]))
alignStats = rbind(alignStats,data.frame(sample,numReads,mappedLeft,mappedRight,mappedPairs))
}
alignStats$numReadFrag = (alignStats$mappedLeft + alignStats$mappedRight)
alignStats$numDeletedPairedReads = (alignStats$mappedLeft + alignStats$mappedRight - alignStats$mappedPairs)
alignStats
alignStats = alignStats[,c("sample","numReads","numReadFrag","mappedPairs","numDeletedPairedReads")]
alignTable = data.frame(t(alignStats))
colnames(alignTable) = alignTable[1,]
alignTable = alignTable[-1,]
alignTable
sampleList = sampleList[-7]
sampleList
alignStats = c()
for(i in sampleList){
x = read.table(file=paste("/Volumes/LauraS/NextGenSeq/BNLx.SHR.Heart.totalRNA/data/rRNA.summary.",i,".txt",sep=""),sep="\t",header=FALSE)
sample = i
numReads = as.numeric(gsub(":","",gsub("Input","",x[2,1])))
mappedLeft = as.numeric(gsub(":","",gsub("Mapped","",unlist(lapply(strsplit(x[3,1],split="(",fixed=TRUE),function(a) a[1])))))
mappedRight = as.numeric(gsub(":","",gsub("Mapped ","",unlist(lapply(strsplit(x[7,1],split="(",fixed=TRUE),function(a) a[1])))))
mappedPairs = as.numeric(gsub("Aligned pairs: ","",x[10,1]))
alignStats = rbind(alignStats,data.frame(sample,numReads,mappedLeft,mappedRight,mappedPairs))
}
alignStats$numReadFrag = (alignStats$mappedLeft + alignStats$mappedRight)
alignStats$numDeletedPairedReads = (alignStats$mappedLeft + alignStats$mappedRight - alignStats$mappedPairs)
alignStats = alignStats[,c("sample","numReads","numReadFrag","mappedPairs","numDeletedPairedReads")]
alignTable = data.frame(t(alignStats))
colnames(alignTable) = alignTable[1,]
alignTable = alignTable[-1,]
alignTable
alignTable$numDeletedPairedReads/alignTable$numReads
as.numeric(alignTable$numDeletedPairedReads)/as.numeric(alignTable$numReads)
as.numeric(alignTable$numDeletedPairedReads)
as.numeric(alignTable["numDeletedPairedReads",])/as.numeric(alignTable["numReads",])
